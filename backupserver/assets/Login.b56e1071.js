import{i as h,d as l,_ as w,e as S,C as b,o as n,c as d,a as o,t as m,n as f,w as v,v as _,b as i}from"./index.3434c1c6.js";import{v as c}from"./index.0d741f8c.js";const{t:p}=h.global;h.global.locale="en";const I=e=>{let r={};const{email:a,password:u}=e;return c.isEmpty(u)&&(r.password=l(()=>p("Error.requiredField"))),c.isEmpty(a)?r.email=l(()=>p("Error.requiredField")):c.isEmail(a)||(r.email=l(()=>p("Error.validEmail"))),{isInvalid:Object.keys(r).length>0,error:r}};h.global;const k={name:"Login",inject:["common"],mixins:[S],emits:["on-current-theme-change"],data(){return{email:"",password:"",error:{},validateOnce:!1}},created(){this.CommonService=new b},watch:{"common.state.SelectedLang":function(e,r){e&&e!=r&&this.validateOnce==!0&&this.login()}},mounted(){let e=localStorage.getItem("theme-colour");localStorage.setItem("theme-colour",e)},methods:{checkError(){let e={email:this.email,password:this.password};const{isInvalid:r,error:a}=I(e);return this.validateOnce=!0,r?(this.error=a,!1):(this.error={},!0)},login(){if(this.checkError())this.CommonService.getLogin(this.email,this.password).then(e=>{if(e.response)e.response.status==400&&(e.response.data.error.password&&(this.error.password=e.response.data.error.password),e.response.data.error.email&&(this.error.email=e.response.data.error.email),e.response.data.validation.body.keys=="email"&&(this.error.email=this.$t("Error.validEmail")));else{let r="";e.status==200&&(this.common.state.userId=e.data.user_id,this.common.state.name=e.data.username,localStorage.setItem("token",e.data.token),localStorage.setItem("uid",e.data.user_id),localStorage.setItem("uname",e.data.username),localStorage.setItem("tokenexpiresAt",e.data.token_expiry),localStorage.setItem("userType",e.data.user_type),localStorage.setItem("profileImage",e.data.profile_image),e.data.user_type=="admin"?(localStorage.setItem("theme-colour","theme-light"),this.$emit("on-current-theme-change","theme-light"),r=localStorage.getItem("redirectPath")||"/admin/news-manager",this.$router.push(r),localStorage.removeItem("redirectPath")):(r=localStorage.getItem("redirectPath")||"/",this.$router.push(r),localStorage.removeItem("redirectPath")))}});else return}}},y={class:"login-wrap"},E={class:"small-container"},x={class:"box"},L=["placeholder"],C={key:0,class:"error-txt"},P=["placeholder"],O={key:0,class:"error-txt"},V={class:"btn-innr"},$=["value"];function B(e,r,a,u,t,g){return n(),d("div",y,[o("div",E,[o("div",x,[o("h2",null,m(e.$t("button.Login")),1),o("form",null,[o("div",{class:f(["form-group",t.error.email?"error":""])},[v(o("input",{type:"email","onUpdate:modelValue":r[0]||(r[0]=s=>t.email=s),placeholder:e.$t("placeholder.EnterEmail"),class:"form-control",maxlength:"150"},null,8,L),[[_,t.email]]),t.error.email?(n(),d("span",C,m(t.error.email),1)):i("v-if",!0)],2),o("div",{class:f(["form-group",t.error.password?"error":""])},[v(o("input",{type:"password",placeholder:e.$t("placeholder.Enterpassword"),class:"form-control","onUpdate:modelValue":r[1]||(r[1]=s=>t.password=s),maxlength:"150"},null,8,P),[[_,t.password]]),t.error.password?(n(),d("span",O,m(t.error.password),1)):i("v-if",!0)],2),o("div",V,[o("input",{readonly:"",class:"btn",value:e.$t("button.Login"),onClick:r[2]||(r[2]=(...s)=>g.login&&g.login(...s))},null,8,$)]),i(' <div class="divider"></div> '),i(` <div class="btn-innr mb-15">\r
            <a class="btn outline" @click="$router.replace('/register')">{{\r
              $t("button.Register")\r
            }}</a>\r
          </div> `),i(` <a class="frgt-txt" @click="$router.replace('/forgot-password')">{{\r
            $t("login.forgotPassword")\r
          }}</a> `)])])])])}const j=w(k,[["render",B],["__file","D:/workspace/11-db-frontend/11_db/src/views/LoginPages/Login.vue"]]);export{j as default};
