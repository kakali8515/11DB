import{_ as p,C as y,d as a,r as C,o as n,c as d,a as r,t as s,n as h,w as f,v as u,b as m,k as g,l as _,F as E}from"./index.904f3d07.js";import{M as w}from"./Modal.89e758e0.js";import{v as c}from"./index.9fddacdb.js";const b={name:"ForgotPassword",inject:["common"],emits:["on-current-theme-change"],components:{Modal:w},data(){return{email:"",error:{},isEmailVerify:!1,validateOnce:!1,isEmailVerifyModal:!1,newTime:"03:00",storeSetInterval:null,emailCode:"",verifyButton:this.$t("button.verify"),isOTPSend:!1}},created(){this.CommonService=new y},watch:{"common.state.SelectedLang":function(e,i){e&&e!=i&&this.validateOnce==!0&&this.verify()}},methods:{verify(){if(!this.isOTPSend){if(c.isEmpty(this.email))return this.error.email=a(()=>this.$t("Error.requiredField")),this.validateOnce=!0,!0;if(c.isEmail(this.email))this.CommonService.resetVerificationCode(this.email).then(e=>{e.status==200?(this.error.email="",this.isEmailVerify=!0,this.isEmailVerifyModal=!0):e.response.status==400?this.error.email=e.response.data.error.email:this.error.email=""}).catch(e=>{});else return this.error.email=a(()=>this.$t("Error.validEmail")),!0}},verifyEmailCode(){this.isEmailVerifyModal=!1,this.verifyButton=a(()=>this.$t("button.resend")),this.isOTPSend=!0,this.storeSetInterval&&clearInterval(this.storeSetInterval),this.timer=180,this.storeSetInterval=setInterval(()=>{let e=Math.floor(this.timer/60),i=this.timer%60;if(e=e<10?"0"+e:e,i=i<10?"0"+i:i,this.newTime=e+":"+i,this.timer>0)return this.timer--;this.newTime="03:00"},1e3),setTimeout(()=>{this.newTime="03:00",this.isOTPSend=!1},(this.timer+1)*1e3)},Check(){if(!this.isEmailVerify)this.error.email=a(()=>this.$t("Error.verifyCode"));else{if(c.isEmpty(this.emailCode))return this.error.verificationCode=a(()=>this.$t("Error.requiredField")),!0;this.CommonService.checkVerificationCode(this.email,this.emailCode).then(e=>{e.status==200?this.$router.push({name:"SettingPassword",params:{id:e.data.user_id,code:this.emailCode}}):e.response.status==400&&(e.response.data.error.verification_code&&(this.error.verificationCode=e.response.data.error.verification_code,this.error.email=""),e.response.data.error.email&&(this.error.email=e.response.data.error.email,this.error.verificationCode=""))}).catch(e=>{})}},closeModal(){this.isEmailVerifyModal=!1}}},M={class:"login-wrap"},T={class:"small-container"},k={class:"box"},S={class:"group"},V=["placeholder"],P={key:0,class:"error-txt"},F={class:"time-group"},O=["placeholder"],B={class:"time"},x={key:0,class:"error-txt"},I={class:"btn-innr"},D=["value"],N={class:"btm-txt"};function q(e,i,L,U,t,l){const v=C("Modal");return n(),d(E,null,[r("div",M,[r("div",T,[r("div",k,[r("h2",null,s(e.$t("forgotPassword.title")),1),r("p",null,s(e.$t("forgotPassword.desc")),1),r("form",null,[r("div",{class:h(["form-group mb-24",t.error.email?"error":""])},[r("div",S,[f(r("input",{type:"email","onUpdate:modelValue":i[0]||(i[0]=o=>t.email=o),placeholder:e.$t("placeholder.EnterEmail"),class:"form-control"},null,8,V),[[u,t.email]]),r("a",{class:h(["btn verify-btn",{isDisabled:t.isOTPSend}]),onClick:i[1]||(i[1]=(...o)=>l.verify&&l.verify(...o))},s(t.verifyButton),3)]),t.error.email?(n(),d("span",P,s(t.error.email),1)):m("v-if",!0)],2),t.isEmailVerify?(n(),d("div",{key:0,class:h(["form-group",t.error.verificationCode?"error":""])},[r("div",F,[f(r("input",{type:"text",placeholder:e.$t("placeholder.verfiycode"),class:"form-control","onUpdate:modelValue":i[2]||(i[2]=o=>t.emailCode=o)},null,8,O),[[u,t.emailCode]]),r("span",B,s(t.newTime),1)]),t.error.verificationCode?(n(),d("span",x,s(t.error.verificationCode),1)):m("v-if",!0)],2)):m("v-if",!0),r("div",I,[r("input",{readonly:"",onClick:i[3]||(i[3]=(...o)=>l.Check&&l.Check(...o)),class:"btn",value:e.$t("button.check")},null,8,D)]),r("div",N,[g(s(e.$t("register.account"))+" ",1),r("a",{onClick:i[4]||(i[4]=o=>e.$router.push("/login")),class:"frgt-txt"},s(e.$t("register.loginHere")),1)])])])])]),t.isEmailVerifyModal?(n(),_(v,{key:0,onClose:l.closeModal,heading:e.$t("modal.forgotPasswordModal.heading"),bodyText:e.$t("modal.forgotPasswordModal.bodyText"),btnText1:e.$t("button.ok"),onConfirm:l.verifyEmailCode,showModal:t.isEmailVerifyModal},null,8,["onClose","heading","bodyText","btnText1","onConfirm","showModal"])):m("v-if",!0)],64)}const $=p(b,[["render",q],["__file","D:/11-db-frontend/11_db/src/views/LoginPages/ForgotPassword.vue"]]);export{$ as default};
